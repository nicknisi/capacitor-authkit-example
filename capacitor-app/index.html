<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WorkOS AuthKit Demo</title>
    <link rel="stylesheet" href="/src/styles.css">
</head>
<body>
    <div class="app">
        <!-- Navigation Bar (shown when authenticated) -->
        <nav id="navbar" class="navbar hidden">
            <div class="nav-container">
                <div class="nav-brand">üîê WorkOS</div>
                <div class="nav-links">
                    <a href="#home" class="nav-link" data-page="home">Home</a>
                    <a href="#account" class="nav-link" data-page="account">Account</a>
                    <a href="#settings" class="nav-link" data-page="settings">Settings</a>
                </div>
            </div>
        </nav>

        <!-- Status Message -->
        <div id="statusMessage" class="status-message hidden"></div>

        <!-- Login View -->
        <div id="loginView" class="page-view">
            <div class="container">
                <div class="header">
                    <h1>üîê WorkOS AuthKit</h1>
                    <p class="subtitle">Capacitor Mobile OAuth Demo</p>
                </div>

                <div class="info-card">
                    <h3>üì± Mobile OAuth Flow</h3>
                    <p>This demo shows WorkOS AuthKit in a Capacitor mobile app with:</p>
                    <ul>
                        <li><strong>Custom URL Scheme:</strong> workosauthdemo://</li>
                        <li><strong>System Browser OAuth:</strong> Secure authentication flow</li>
                        <li><strong>Next.js Backend:</strong> Token exchange with roles & permissions</li>
                        <li><strong>Enhanced Session:</strong> RBAC, organizations, entitlements</li>
                    </ul>
                </div>

                <button id="loginBtn" class="primary-btn">
                    Sign In with WorkOS
                </button>

                <div class="info-card">
                    <h4>What happens when you sign in:</h4>
                    <ol>
                        <li>App opens system browser with WorkOS AuthKit</li>
                        <li>You authenticate using WorkOS</li>
                        <li>WorkOS redirects to: <code>workosauthdemo://callback?code=...</code></li>
                        <li>iOS/Android intercepts URL and returns to app</li>
                        <li>App sends code to Next.js backend</li>
                        <li>Backend exchanges code for tokens with full user data</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Home View -->
        <div id="homeView" class="page-view hidden">
            <div class="container">
                <div class="header">
                    <h2>Welcome Back! üëã</h2>
                </div>

                <div class="user-card">
                    <div id="homeUserInfo"></div>
                </div>

                <div class="button-group">
                    <button id="homeRefreshBtn" class="secondary-btn">
                        üîÑ Refresh Session
                    </button>
                    <button id="homeSignOutBtn" class="danger-btn">
                        üö™ Sign Out
                    </button>
                </div>

                <div class="info-card">
                    <h4>Features Available</h4>
                    <ul>
                        <li><strong>Account Page:</strong> View your full profile, roles, and permissions</li>
                        <li><strong>Settings Page:</strong> Switch organizations, debug session, view claims</li>
                        <li><strong>Session Management:</strong> Automatic token refresh</li>
                        <li><strong>RBAC:</strong> Role-based access control</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Account View -->
        <div id="accountView" class="page-view hidden">
            <div class="container">
                <div class="header">
                    <h2>üë§ Account</h2>
                </div>

                <div class="user-card">
                    <h3>Profile Information</h3>
                    <div id="accountUserInfo"></div>
                </div>

                <div class="user-card" id="rolesCard">
                    <h3>Roles & Permissions</h3>
                    <div id="accountRolesInfo"></div>
                </div>

                <div class="user-card" id="orgCard">
                    <h3>Organization</h3>
                    <div id="accountOrgInfo"></div>
                </div>

                <div class="user-card" id="entitlementsCard">
                    <h3>Entitlements & Feature Flags</h3>
                    <div id="accountEntitlementsInfo"></div>
                </div>
            </div>
        </div>

        <!-- Settings View -->
        <div id="settingsView" class="page-view hidden">
            <div class="container">
                <div class="header">
                    <h2>‚öôÔ∏è Settings</h2>
                </div>

                <div class="user-card" id="orgSwitcherCard">
                    <h3>Organization Switcher</h3>
                    <p>Switch between organizations you belong to</p>
                    <div id="orgSwitcherContainer">
                        <div class="loading">Loading organizations...</div>
                    </div>
                </div>

                <div class="user-card">
                    <h3>Session Management</h3>
                    <div class="button-group">
                        <button id="settingsRefreshBtn" class="secondary-btn">
                            üîÑ Refresh Session
                        </button>
                        <button id="settingsSignOutBtn" class="danger-btn">
                            üö™ Sign Out
                        </button>
                    </div>
                </div>

                <div class="info-card">
                    <h4>üîç Session Debug</h4>
                    <div id="sessionDebugInfo" class="debug-info"></div>
                </div>

                <div class="info-card">
                    <h4>üìú Token Claims</h4>
                    <div id="tokenClaimsInfo" class="debug-info"></div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/src/main.ts"></script>
</body>
</html>
